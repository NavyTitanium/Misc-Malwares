## PHP Backdoor

Request done by a TOR exit node
```
Accept-Encoding: gzip
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0
Content-Length: 89
Connection: close
X-Forwarded-For: 130.225.244.90
Host: <Infected site>
X-Accel-Internal: /nginx_static_files
```

Creates a cron job to run every minutes
```
* * * * * /<path of the bin> > /dev/null 2>&1
```

## Stub_Linux_x86.test
file [Stub_Linux_x86.test](https://www.virustotal.com/gui/file/6b463e18e01f47269d6cd7509aa6d2788cc2e7473bc9b8169bdb003f2f61c913/): **ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, stripped**

| Hash type  | Hash value :paw_prints: |
| ------------- | ------------- |
| MD5  | 162ea298df96b592edeffecce0f7662a  | 
| SHA-1  | 574c030e05af292ee478d33b40833a224ace0220  | 
| SHA-256  | 6b463e18e01f47269d6cd7509aa6d2788cc2e7473bc9b8169bdb003f2f61c913  | 
	
### Version 3.09

<details>
  <summary>:small_orange_diamond:WooCommerce, HTTP GET /gw?worker=Woo</summary> 
  
 ```
StealthWorker/Worker_WooChk.init
StealthWorker/Worker_WooChk.saveGood
StealthWorker/Worker_WooChk.userEnumerate
StealthWorker/Worker_WooChk.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:wpMagOcart, HTTP GET /gw?worker=OCartBrt</summary>
  
 ```
StealthWorker/Worker_wpMagOcart.init
StealthWorker/Worker_wpMagOcart.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Admin Finder, HTTP GET /gw?worker=admfind</summary>
  
 ```
StealthWorker/WorkerAdminFinder.GetPage
StealthWorker/WorkerAdminFinder.GetPage.func1
StealthWorker/WorkerAdminFinder.init
StealthWorker/WorkerAdminFinder.SaveGood
StealthWorker/WorkerAdminFinder.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Backup finder</summary>
  
 ```
StealthWorker/WorkerBackup_finder.HttpCheck
StealthWorker/WorkerBackup_finder.HttpCheck.func1
StealthWorker/WorkerBackup_finder.init
StealthWorker/WorkerBackup_finder.SaveGood
StealthWorker/WorkerBackup_finder.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Bitrix</summary>
  
 ```
StealthWorker/WorkerBitrix_brut.(*WP).HttpClient
StealthWorker/WorkerBitrix_brut.(*WP).HttpClient.func1
StealthWorker/WorkerBitrix_brut.(*WP).Init
StealthWorker/WorkerBitrix_brut.(*WP).Login
StealthWorker/WorkerBitrix_brut.init
StealthWorker/WorkerBitrix_brut.SaveGood
StealthWorker/WorkerBitrix_brut.Worker
StealthWorker/WorkerBitrix_check.init
StealthWorker/WorkerBitrix_check.saveGood
StealthWorker/WorkerBitrix_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:CPanel</summary>
  
 ```
StealthWorker/WorkerCpanel_brut.Brut
StealthWorker/WorkerCpanel_brut.Brut.func1
StealthWorker/WorkerCpanel_brut.Brut.func2
StealthWorker/WorkerCpanel_brut.init
StealthWorker/WorkerCpanel_brut.SaveGood
StealthWorker/WorkerCpanel_brut.Worker
StealthWorker/WorkerCpanel_check.DetectCMS
StealthWorker/WorkerCpanel_check.init
StealthWorker/WorkerCpanel_check.saveGood
StealthWorker/WorkerCpanel_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Drupal</summary>
  
 ```
StealthWorker/WorkerDrupal_brut.(*WP).HttpClient
StealthWorker/WorkerDrupal_brut.(*WP).HttpClient.func1
StealthWorker/WorkerDrupal_brut.(*WP).Init
StealthWorker/WorkerDrupal_brut.(*WP).Login
StealthWorker/WorkerDrupal_brut.init
StealthWorker/WorkerDrupal_brut.SaveGood
StealthWorker/WorkerDrupal_brut.Worker
StealthWorker/WorkerDrupal_check.init
StealthWorker/WorkerDrupal_check.saveGood
StealthWorker/WorkerDrupal_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:FTP</summary>
  
 ```
StealthWorker/WorkerFTP_brut.Brut
StealthWorker/WorkerFTP_brut.CheckFalsePositive
StealthWorker/WorkerFTP_brut.init
StealthWorker/WorkerFTP_brut.SaveGood
StealthWorker/WorkerFTP_brut.Worker
StealthWorker/WorkerFTP_brut.Worker.func1
StealthWorker/WorkerFTP_check.init
StealthWorker/WorkerFTP_check.saveGood
StealthWorker/WorkerFTP_check.ScanPort
StealthWorker/WorkerFTP_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Htpasswd</summary>
  
 ```
StealthWorker/WorkerHtpasswd_brut.(*WP).HttpClient
StealthWorker/WorkerHtpasswd_brut.(*WP).HttpClient.func1
StealthWorker/WorkerHtpasswd_brut.init
StealthWorker/WorkerHtpasswd_brut.SaveGood
StealthWorker/WorkerHtpasswd_brut.Worker
StealthWorker/WorkerHtpasswd_check.HttpClient
StealthWorker/WorkerHtpasswd_check.HttpClient.func1
StealthWorker/WorkerHtpasswd_check.init
StealthWorker/WorkerHtpasswd_check.saveGood
StealthWorker/WorkerHtpasswd_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Joomla</summary>
  
 ```
StealthWorker/WorkerJoomla_brut.(*WP).HttpClient
StealthWorker/WorkerJoomla_brut.(*WP).HttpClient.func1
StealthWorker/WorkerJoomla_brut.(*WP).Init
StealthWorker/WorkerJoomla_brut.(*WP).Login
StealthWorker/WorkerJoomla_brut.init
StealthWorker/WorkerJoomla_brut.SaveGood
StealthWorker/WorkerJoomla_brut.Worker
StealthWorker/WorkerJoomla_check.init
StealthWorker/WorkerJoomla_check.saveGood
StealthWorker/WorkerJoomla_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Magento</summary>
  
 ```
StealthWorker/WorkerMagento_brut.basicAuth
StealthWorker/WorkerMagento_brut.BrutDownloader
StealthWorker/WorkerMagento_brut.BrutDownloader.func1
StealthWorker/WorkerMagento_brut.BrutPanel
StealthWorker/WorkerMagento_brut.BrutPanel.func1
StealthWorker/WorkerMagento_brut.BrutRSS
StealthWorker/WorkerMagento_brut.BrutRSS.func1
StealthWorker/WorkerMagento_brut.init
StealthWorker/WorkerMagento_brut.SaveGood
StealthWorker/WorkerMagento_brut.Worker
StealthWorker/WorkerMagento_check.init
StealthWorker/WorkerMagento_check.saveGood
StealthWorker/WorkerMagento_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Mysql</summary>
  
 ```
StealthWorker/WorkerMysql_brut.Brut
StealthWorker/WorkerMysql_brut.Brut.func1
StealthWorker/WorkerMysql_brut.Brut.func1.1
StealthWorker/WorkerMysql_brut.init
StealthWorker/WorkerMysql_brut.SaveGood
StealthWorker/WorkerMysql_brut.Worker
StealthWorker/WorkerMysql_brut.Worker.func1
 ```
</details>

<details>
  <summary>:small_orange_diamond:Opencart</summary>
  
 ```
StealthWorker/WorkerOpencart_brut.(*WP).HttpClient
StealthWorker/WorkerOpencart_brut.(*WP).HttpClient.func1
StealthWorker/WorkerOpencart_brut.(*WP).Init
StealthWorker/WorkerOpencart_brut.init
StealthWorker/WorkerOpencart_brut.newfileUploadRequest
StealthWorker/WorkerOpencart_brut.SaveGood
StealthWorker/WorkerOpencart_brut.Worker
StealthWorker/WorkerOpencart_check.init
StealthWorker/WorkerOpencart_check.saveGood
StealthWorker/WorkerOpencart_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:PMA</summary>
  
 ```
StealthWorker/WorkerPMA_brut.(*Instance).CheckSuccessFull
StealthWorker/WorkerPMA_brut.(*Instance).HttpClient
StealthWorker/WorkerPMA_brut.(*Instance).HttpClient.func1
StealthWorker/WorkerPMA_brut.(*Instance).ParseForm
StealthWorker/WorkerPMA_brut.(*Instance).TryLogin
StealthWorker/WorkerPMA_brut.init
StealthWorker/WorkerPMA_brut.Instance.CheckSuccessFull
StealthWorker/WorkerPMA_brut.SaveGood
StealthWorker/WorkerPMA_brut.Worker
StealthWorker/WorkerPMA_check.DetectCMS
StealthWorker/WorkerPMA_check.init
StealthWorker/WorkerPMA_check.saveGood
StealthWorker/WorkerPMA_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:Postgres</summary>
  
 ```
StealthWorker/WorkerPostgres_brut.Brut
StealthWorker/WorkerPostgres_brut.init
StealthWorker/WorkerPostgres_brut.SaveGood
StealthWorker/WorkerPostgres_brut.Worker
StealthWorker/WorkerPostgres_brut.Worker.func1
 ```
</details>

<details>
  <summary>:small_orange_diamond:Qnap</summary>
  
 ```
StealthWorker/WorkerQnap_brut.HttpClient
StealthWorker/WorkerQnap_brut.HttpClient.func1
StealthWorker/WorkerQnap_brut.init
StealthWorker/WorkerQnap_brut.newfileUploadRequest
StealthWorker/WorkerQnap_brut.SaveGood
StealthWorker/WorkerQnap_brut.Worker
StealthWorker/WorkerQnap_check.init
StealthWorker/WorkerQnap_check.saveGood
StealthWorker/WorkerQnap_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:SSH</summary>
  
 ```
StealthWorker/WorkerSSH_brut.Brut
StealthWorker/WorkerSSH_brut.check_honeypot
StealthWorker/WorkerSSH_brut.Exe_cmd
StealthWorker/WorkerSSH_brut.Exe_cmd.func1
StealthWorker/WorkerSSH_brut.init
StealthWorker/WorkerSSH_brut.SaveGood
StealthWorker/WorkerSSH_brut.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:WHM</summary>
  
 ```
StealthWorker/WorkerWHM_brut.Brut
StealthWorker/WorkerWHM_brut.Brut.func2
StealthWorker/WorkerWHM_brut.Brut.func3
StealthWorker/WorkerWHM_brut.init
StealthWorker/WorkerWHM_brut.SaveGood
StealthWorker/WorkerWHM_brut.Worker
StealthWorker/WorkerWHM_check.DetectCMS
StealthWorker/WorkerWHM_check.init
StealthWorker/WorkerWHM_check.saveGood
StealthWorker/WorkerWHM_check.Worker
 ```
</details>

<details>
  <summary>:small_orange_diamond:WordPress</summary>
  
 ```
StealthWorker/Worker_WpInstall_finder.init
StealthWorker/Worker_WpInstall_finder.Init
StealthWorker/Worker_WpInstall_finder.saveGood
StealthWorker/Worker_WpInstall_finder.Worker
StealthWorker/WorkerWP_brut.(*WP).brutXmlRpc
StealthWorker/WorkerWP_brut.(*WP).HttpClient
StealthWorker/WorkerWP_brut.(*WP).HttpClient.func1
StealthWorker/WorkerWP_brut.(*WP).Init
StealthWorker/WorkerWP_brut.(*WP).Login
StealthWorker/WorkerWP_brut.checkBrutOk
StealthWorker/WorkerWP_brut.checkMustAddWWW
StealthWorker/WorkerWP_brut.checkMustSwitchScheme
StealthWorker/WorkerWP_brut.init
StealthWorker/WorkerWP_brut.SaveGood
StealthWorker/WorkerWP_brut.Worker
StealthWorker/WorkerWP_check.init
StealthWorker/WorkerWP_check.saveGood
StealthWorker/WorkerWP_check.userEnumerate
StealthWorker/WorkerWP_check.Worker
```
</details>


## OSINT
```
dig +nocmd marsiane.at any +multiline +noall +answer
marsiane.at.            3559 IN A 87.251.70.54
```
```
WHOIS marsiane.at  ?
Email	mammy@derbaroder.at 
Name Tarja Makinen 
Phone	3580462545976

Other domains registered with the same phone number:
jordriol.at
derbaroder.at

Other domains pointing at this IP:
et53.info
pity54.info
zipfrigate.net
epipaapdoqaedacy.info
```

87.251.70.54 Announced By
| Origin AS  | Announcement | ASN Description  | Registrant Name |
| ------------- | ------------- | ------------- | ------------- |
| AS49877  | 87.251.70.0/23  | 	RMINJINERING, RU | SA Geocentru |




## IoCs
